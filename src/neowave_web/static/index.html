<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Fractal NEoWave Engine</title>
    <link rel="icon" type="image/svg+xml" href="/static/favicon.svg" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;600;700&family=DM+Mono:wght@400;500&display=swap"
      rel="stylesheet"
    />
    <script src="/static/lightweight-charts.standalone.production.js"></script>
    <style>
      :root {
        --bg: #050910;
        --panel: rgba(10, 14, 22, 0.92);
        --border: 1px solid rgba(255, 255, 255, 0.08);
        --text: #dfe7ff;
        --muted: #7f8ea3;
        --accent: #38f0c4;
        --accent-2: #ff7f50;
        --mono: "DM Mono", monospace;
        --shadow: 0 12px 40px rgba(0, 0, 0, 0.35);
      }
      * {
        box-sizing: border-box;
      }
      body {
        margin: 0;
        min-height: 100vh;
        background: radial-gradient(circle at 15% 20%, rgba(56, 240, 196, 0.08), transparent 28%),
          radial-gradient(circle at 80% 80%, rgba(255, 127, 80, 0.08), transparent 25%), var(--bg);
        color: var(--text);
        font-family: "Space Grotesk", "Inter", system-ui, -apple-system, sans-serif;
        display: flex;
        flex-direction: column;
        gap: 12px;
        padding: 14px;
      }
      header {
        display: flex;
        align-items: center;
        justify-content: space-between;
        padding: 14px 18px;
        border: var(--border);
        border-radius: 14px;
        background: linear-gradient(145deg, rgba(12, 18, 30, 0.92), rgba(8, 12, 22, 0.9));
        box-shadow: var(--shadow);
      }
      .title {
        font-weight: 700;
        letter-spacing: -0.4px;
        font-size: 18px;
      }
      .title span {
        font-family: var(--mono);
        color: var(--accent);
      }
      .status {
        display: flex;
        gap: 12px;
        align-items: center;
        color: var(--muted);
        font-size: 13px;
      }
      .dot {
        width: 10px;
        height: 10px;
        border-radius: 50%;
        background: linear-gradient(145deg, #38f0c4, #1abc9c);
        box-shadow: 0 0 12px rgba(56, 240, 196, 0.6);
      }
      main {
        display: grid;
        grid-template-columns: 320px 1fr 360px;
        gap: 12px;
        align-items: stretch;
        min-height: 0;
        flex: 1;
      }
      .panel {
        background: var(--panel);
        border: var(--border);
        border-radius: 14px;
        padding: 14px;
        box-shadow: var(--shadow);
        display: flex;
        flex-direction: column;
        gap: 12px;
        min-height: 0;
      }
      h2 {
        margin: 0;
        font-size: 14px;
        text-transform: uppercase;
        letter-spacing: 1px;
        color: var(--muted);
      }
      .control-grid {
        display: grid;
        grid-template-columns: repeat(2, minmax(0, 1fr));
        gap: 10px;
      }
      label {
        font-size: 12px;
        color: var(--muted);
      }
      input,
      select {
        width: 100%;
        padding: 10px;
        border-radius: 10px;
        border: var(--border);
        background: rgba(255, 255, 255, 0.02);
        color: var(--text);
        font-family: var(--mono);
      }
      input[type="range"] {
        padding: 0;
      }
      button {
        border: none;
        border-radius: 10px;
        padding: 12px;
        font-weight: 700;
        cursor: pointer;
        background: linear-gradient(120deg, var(--accent), #26c9f7);
        color: #000;
      }
      .metric {
        display: flex;
        align-items: center;
        justify-content: space-between;
        padding: 8px 10px;
        border-radius: 10px;
        background: rgba(255, 255, 255, 0.02);
        border: 1px solid rgba(255, 255, 255, 0.06);
        font-family: var(--mono);
        font-size: 12px;
      }
      .chart-wrapper {
        position: relative;
        flex: 1;
      }
      .panel-header {
        display: flex;
        align-items: center;
        justify-content: space-between;
        gap: 10px;
      }
      .chart-actions {
        display: flex;
        align-items: center;
        gap: 8px;
        color: var(--muted);
        font-size: 12px;
      }
      .selection-label {
        padding: 6px 10px;
        border-radius: 10px;
        background: rgba(255, 255, 255, 0.04);
        border: 1px solid rgba(255, 255, 255, 0.08);
      }
      .btn-verify {
        background: linear-gradient(120deg, #ff7f50, #f5a623);
        color: #0a0e16;
        border-radius: 12px;
        padding: 10px 14px;
        font-size: 12px;
        border: none;
        cursor: pointer;
        box-shadow: 0 10px 30px rgba(255, 127, 80, 0.35);
      }
      .btn-verify:disabled {
        opacity: 0.4;
        cursor: not-allowed;
        box-shadow: none;
      }
      .verify-badge {
        padding: 6px 10px;
        border-radius: 12px;
        border: 1px solid rgba(255, 255, 255, 0.08);
        background: rgba(255, 255, 255, 0.04);
        font-size: 12px;
      }
      .verify-badge.success {
        color: #1abc9c;
        border-color: rgba(26, 188, 156, 0.5);
        background: rgba(26, 188, 156, 0.08);
      }
      .verify-badge.fail {
        color: #ff7f50;
        border-color: rgba(255, 127, 80, 0.5);
        background: rgba(255, 127, 80, 0.08);
      }
      #tv-chart {
        width: 100%;
        height: 100%;
      }
      .scenario-list {
        display: flex;
        flex-direction: column;
        gap: 10px;
        overflow-y: auto;
      }
      .scenario-card {
        border: var(--border);
        border-radius: 12px;
        padding: 12px;
        background: rgba(255, 255, 255, 0.02);
        transition: border-color 0.2s ease, box-shadow 0.2s ease;
        cursor: pointer;
      }
      .scenario-card.active {
        border-color: rgba(56, 240, 196, 0.5);
        box-shadow: 0 0 0 1px rgba(56, 240, 196, 0.15);
      }
      .scenario-card h3 {
        margin: 0 0 6px 0;
        font-size: 14px;
      }
      .scenario-card small {
        color: var(--muted);
      }
      .scenario-meta {
        display: flex;
        align-items: center;
        justify-content: space-between;
        gap: 8px;
      }
      .probability-badge {
        padding: 6px 8px;
        border-radius: 10px;
        background: rgba(56, 240, 196, 0.12);
        color: var(--accent);
        font-family: var(--mono);
        font-size: 11px;
        border: 1px solid rgba(56, 240, 196, 0.4);
      }
      .badge {
        display: inline-flex;
        align-items: center;
        gap: 4px;
        padding: 4px 8px;
        border-radius: 8px;
        background: rgba(56, 240, 196, 0.12);
        color: var(--accent);
        font-family: var(--mono);
        font-size: 11px;
        margin-right: 6px;
        margin-top: 4px;
        border: 1px solid rgba(56, 240, 196, 0.25);
      }
      .validation-badge {
        display: inline-flex;
        align-items: center;
        gap: 6px;
        padding: 6px 10px;
        border-radius: 10px;
        background: rgba(255, 255, 255, 0.04);
        border: 1px dashed rgba(255, 255, 255, 0.08);
        font-size: 12px;
        color: var(--muted);
      }
      .validation-badge.danger {
        color: #ffb199;
        border-color: rgba(255, 127, 80, 0.45);
        background: rgba(255, 127, 80, 0.08);
      }
      .badge.invalid {
        background: rgba(255, 127, 80, 0.12);
        color: #ffb199;
        border-color: rgba(255, 127, 80, 0.5);
      }
      .validation {
        margin-top: 8px;
        font-size: 12px;
        color: var(--muted);
      }
      .pill {
        padding: 6px 10px;
        border-radius: 8px;
        border: 1px solid rgba(255, 255, 255, 0.08);
        background: rgba(255, 255, 255, 0.02);
      }
      .callout {
        padding: 10px;
        border-radius: 10px;
        background: rgba(255, 127, 80, 0.08);
        border: 1px dashed rgba(255, 127, 80, 0.5);
        font-size: 12px;
      }
      .tooltip {
        position: fixed;
        right: 16px;
        bottom: 16px;
        max-width: 320px;
        padding: 12px;
        border-radius: 12px;
        background: #0c101a;
        border: 1px solid rgba(255, 255, 255, 0.1);
        box-shadow: var(--shadow);
        font-size: 12px;
        display: none;
      }
      @media (max-width: 1100px) {
        main {
          grid-template-columns: 1fr;
        }
      }
    </style>
  </head>
  <body>
    <header>
      <div class="title">Fractal <span>NEoWave</span> Engine</div>
      <div class="status">
        <div class="dot"></div>
        <span id="status-text">Ready</span>
      </div>
    </header>
    <main>
      <section class="panel">
        <h2>Controls</h2>
        <div class="control-grid">
          <div>
            <label>Symbol</label>
            <input id="input-symbol" value="BTCUSD" />
          </div>
          <div>
            <label>Interval</label>
            <select id="input-interval">
              <option value="1hour">1H</option>
              <option value="30min">30m</option>
              <option value="4hour">4H</option>
              <option value="1day">1D</option>
            </select>
          </div>
          <div>
            <label>Target Waves</label>
            <input id="input-target" type="range" min="10" max="100" value="40" />
            <div class="metric"><span>View target</span><span id="target-label">40</span></div>
          </div>
          <div>
            <label>Retrace Price</label>
            <input id="input-retrace-price" type="number" step="0.01" value="0.236" />
          </div>
          <div>
            <label>Retrace Time</label>
            <input id="input-retrace-time" type="number" step="0.01" value="0.2" />
          </div>
          <div>
            <label>Similarity (1/3 rule)</label>
            <input id="input-similarity" type="number" step="0.01" value="0.33" />
          </div>
        </div>
        <button id="btn-refresh">Analyze</button>
        <div class="metric"><span>Monowaves</span><span id="mono-count">-</span></div>
        <div class="metric"><span>Scenarios</span><span id="scenario-count">-</span></div>
        <div class="callout">Macro/Base/Micro 버튼 없이 하나의 프랙탈 트리에서 원하는 뷰 레벨을 선택합니다.</div>
      </section>
      <section class="panel chart-wrapper">
        <div class="panel-header">
          <h2>Chart</h2>
          <div class="chart-actions">
            <span class="selection-label" id="selection-label">Select a scenario</span>
            <button id="btn-verify" class="btn-verify" disabled>Verify</button>
            <span class="verify-badge" id="verify-status" style="display:none;">Pending</span>
          </div>
        </div>
        <div id="tv-chart"></div>
      </section>
      <section class="panel">
        <h2>Scenarios</h2>
        <div class="scenario-list" id="scenario-list"></div>
      </section>
    </main>
    <div class="tooltip" id="rule-tooltip"></div>
    <script src="/static/app.js"></script>
  </body>
</html>
